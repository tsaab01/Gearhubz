<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KXB4P8MJ');</script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Free Online Image Cropper - Crop Images to Exact Size | ToolsHub</title>
    <meta name="description" content="Crop images online for free! Cut photos to exact dimensions for profile pictures, social media, and more. No signup required. Fast and easy to use.">
    <meta name="keywords" content="image cropper, crop image online, photo cropper, free image tool, online image editor, crop photos, image editing">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Free Online Image Cropper - ToolsHub">
    <meta property="og:description" content="Crop your images to exact dimensions. Perfect for profile pictures, social media posts, and more.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/image-cropper">
    <meta property="og:site_name" content="ToolsHub">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Free Online Image Cropper">
    <meta name="twitter:description" content="Crop images online for free! Cut photos to exact dimensions for profile pictures, social media, and more.">
    
    <!-- Canonical and other meta tags -->
    <link rel="canonical" href="https://yourdomain.com/image-cropper">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #7209b7;
            --light: #f8f9fa;
            --dark: #212529;
            --gradient-primary: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            --shadow: 0 8px 25px rgba(67, 97, 238, 0.15);
            --deep-shadow: 0 15px 35px rgba(67, 97, 238, 0.25);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: white;
            box-shadow: var(--shadow);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .tool-header {
            text-align: center;
            padding: 3rem 0 2rem 0;
        }

        .tool-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .tool-header p {
            font-size: 1.1rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }

        .tool-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 768px) {
            .tool-container {
                grid-template-columns: 1fr;
            }
            
            .tool-header h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 15px;
            }
            
            .tool-container {
                gap: 1.5rem;
            }
        }

        .upload-section, .preview-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            height: fit-content;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: var(--dark);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
        }

        .upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1.5rem;
            background: #fafafa;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.03);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .upload-text h4 {
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .upload-text p {
            color: #666;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
        }

        .upload-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .preset-btn {
            flex: 1;
            min-width: 80px;
            padding: 10px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .preset-btn:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }

        .preset-btn.active {
            background: var(--gradient-primary);
            color: white;
            border-color: var(--primary);
        }

        .custom-dimensions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .dimension-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .control-group {
            margin: 1.5rem 0;
        }

        .control-label {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-label i {
            color: var(--primary);
        }

        .action-btn {
            width: 100%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .action-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .preview-container {
            width: 100%;
            height: 300px;
            border: 2px dashed #e0e0e0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            overflow: hidden;
            background: #fafafa;
            position: relative;
        }

        .preview-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: none;
        }

        .crop-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .crop-selection {
            position: absolute;
            border: 2px dashed var(--primary);
            background: rgba(67, 97, 238, 0.2);
            cursor: move;
        }

        .crop-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            pointer-events: all;
        }

        .handle-nw { top: -6px; left: -6px; cursor: nw-resize; }
        .handle-ne { top: -6px; right: -6px; cursor: ne-resize; }
        .handle-sw { bottom: -6px; left: -6px; cursor: sw-resize; }
        .handle-se { bottom: -6px; right: -6px; cursor: se-resize; }

        .tool-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .info-item {
            background: var(--light);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .info-item h5 {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .info-item p {
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
        }

        .status-message {
            text-align: center;
            padding: 12px;
            margin-top: 15px;
            border-radius: 8px;
            display: none;
            font-weight: 500;
        }

        .status-message.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        .status-message.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        .processing {
            text-align: center;
            color: var(--primary);
            display: none;
            padding: 15px;
        }

        .processing i {
            animation: spin 1s linear infinite;
            margin-right: 10px;
            font-size: 1.2rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        footer {
            text-align: center;
            padding: 2rem 0;
            color: #666;
            font-size: 0.9rem;
            background: white;
            border-radius: 12px;
            margin-top: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        /* SEO Content Section */
        .seo-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .seo-content h2 {
            font-size: 1.8rem;
            margin: 25px 0 15px 0;
            color: var(--dark);
        }

        .seo-content h3 {
            font-size: 1.4rem;
            margin: 20px 0 10px 0;
            color: var(--dark);
        }

        .seo-content p {
            margin-bottom: 15px;
            color: #666;
        }

        .seo-content ul, .seo-content ol {
            margin: 15px 0 15px 30px;
            color: #666;
        }

        .seo-content li {
            margin-bottom: 10px;
        }

        .benefits-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .benefit-item {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
        }

        .benefit-item h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        /* Toggle Styles */
        .toggle-container {
            margin: 15px 0;
        }

        .toggle-header {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            transition: background 0.3s;
        }

        .toggle-header:hover {
            background: #e5e7eb;
        }

        .toggle-header h4 {
            margin: 0;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .toggle-icon {
            transition: transform 0.3s;
        }

        .toggle-content {
            padding: 15px;
            background: white;
            border-left: 3px solid var(--primary);
            display: none;
        }

        .toggle-content.active {
            display: block;
        }

        .related-tools {
            margin-top: 30px;
            text-align: center;
        }

        .tools-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .tool-link {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            text-decoration: none;
            transition: background 0.3s;
        }

        .tool-link:hover {
            background: var(--secondary);
        }

        @media (max-width: 768px) {
            .benefits-list {
                grid-template-columns: 1fr;
            }
            
            .custom-dimensions {
                flex-direction: column;
            }
        }
    </style>
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Image Cropper",
      "description": "Free online tool to crop images to exact dimensions",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.7",
        "reviewCount": "1180"
      }
    }
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXB4P8MJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <header>
        <div class="container header-container">
            <a href="/" class="logo">
                <i class="fas fa-tools"></i> Tools Hub
            </a>
        </div>
    </header>

    <section class="tool-header">
        <div class="container">
            <h1><i class="fas fa-crop-alt"></i> Free Online Image Cropper</h1>
            <p>Crop your images to exact dimensions. Perfect for profile pictures, social media posts, and more.</p>
        </div>
    </section>

    <section class="tool-main">
        <div class="container">
            <div class="tool-container">
                <!-- Upload Section -->
                <div class="upload-section">
                    <h3 class="section-title"><i class="fas fa-upload"></i> Upload Your Image</h3>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">
                            <h4>Drag & Drop or Click to Upload</h4>
                            <p>Supports JPG, PNG, GIF, WEBP (Max: 5MB)</p>
                        </div>
                        <button class="upload-btn" id="uploadBtn">
                            <i class="fas fa-folder-open"></i> Choose File
                        </button>
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-expand"></i> Crop Presets:
                        </div>
                        <div class="preset-buttons">
                            <button class="preset-btn active" data-ratio="1:1">1:1</button>
                            <button class="preset-btn" data-ratio="4:3">4:3</button>
                            <button class="preset-btn" data-ratio="16:9">16:9</button>
                            <button class="preset-btn" data-ratio="custom">Custom</button>
                        </div>
                        
                        <div class="custom-dimensions" id="customDimensions" style="display: none;">
                            <input type="number" class="dimension-input" id="customWidth" placeholder="Width" min="1">
                            <input type="number" class="dimension-input" id="customHeight" placeholder="Height" min="1">
                        </div>
                    </div>

                    <button class="action-btn" id="cropBtn" disabled>
                        <i class="fas fa-crop-alt"></i> Crop Image
                    </button>
                </div>
                
                <!-- Preview Section -->
                <div class="preview-section">
                    <h3 class="section-title"><i class="fas fa-eye"></i> Preview & Download</h3>
                    <div class="preview-container" id="previewContainer">
                        <div style="text-align: center; color: #999;">
                            <i class="fas fa-image" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>Your image will appear here</p>
                        </div>
                        <img id="previewImage" alt="Preview">
                        <div class="crop-overlay" id="cropOverlay">
                            <div class="crop-selection" id="cropSelection"></div>
                        </div>
                    </div>
                    
                    <div class="processing" id="processing">
                        <i class="fas fa-spinner"></i> Processing image...
                    </div>
                    
                    <div class="tool-info">
                        <div class="info-item">
                            <h5>ORIGINAL SIZE</h5>
                            <p id="originalSize">-</p>
                        </div>
                        <div class="info-item">
                            <h5>CROPPED SIZE</h5>
                            <p id="croppedSize">-</p>
                        </div>
                        <div class="info-item">
                            <h5>DIMENSIONS</h5>
                            <p id="cropDimensions">-</p>
                        </div>
                        <div class="info-item">
                            <h5>SPACE SAVED</h5>
                            <p id="spaceSaved">-</p>
                        </div>
                    </div>
                    
                    <button class="action-btn" id="downloadBtn" disabled>
                        <i class="fas fa-download"></i> Download Cropped Image
                    </button>
                    <div class="status-message" id="statusMessage"></div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- SEO Content Section -->
    <section class="seo-content">
        <article>
            <h2>What is an Online Image Cropper?</h2>
            <p>An online image cropper is a free web-based tool that allows you to cut and trim your digital images to exact dimensions. Whether you need to create perfect profile pictures, social media posts, banner images, or remove unwanted parts of a photo, our tool makes it quick and easy with precise cropping controls.</p>
            
            <h2>Why Use Our Free Image Cropper?</h2>
            <div class="benefits-list">
                <div class="benefit-item">
                    <h4><i class="fas fa-bolt"></i> Precise Cropping</h4>
                    <p>Drag and resize the crop area to exact pixel dimensions for perfect results.</p>
                </div>
                <div class="benefit-item">
                    <h4><i class="fas fa-lock"></i> Privacy Protected</h4>
                    <p>Your images are processed locally and never stored on our servers.</p>
                </div>
                <div class="benefit-item">
                    <h4><i class="fas fa-mobile-alt"></i> Works on All Devices</h4>
                    <p>Use on desktop, tablet, or mobile phone with any browser.</p>
                </div>
                <div class="benefit-item">
                    <h4><i class="fas fa-infinity"></i> Unlimited Crops</h4>
                    <p>Crop as many images as you want - completely free forever.</p>
                </div>
            </div>
            
            <h2>Popular Cropping Use Cases</h2>
            <div class="toggle-container">
                <div class="toggle-header" onclick="toggleContent('use1')">
                    <h4>Social Media Profiles</h4>
                    <i class="fas fa-chevron-down toggle-icon" id="icon-use1"></i>
                </div>
                <div class="toggle-content" id="content-use1">
                    <p>Create perfect profile pictures and cover photos for Facebook, Instagram, Twitter, LinkedIn, and other social platforms. Each platform has specific size requirements - our tool helps you meet them exactly. Crop your photos to the right aspect ratio for professional-looking profiles.</p>
                </div>
            </div>
            
            <div class="toggle-container">
                <div class="toggle-header" onclick="toggleContent('use2')">
                    <h4>E-commerce Product Images</h4>
                    <i class="fas fa-chevron-down toggle-icon" id="icon-use2"></i>
                </div>
                <div class="toggle-content" id="content-use2">
                    <p>Prepare product photos for online stores and marketplaces. Remove backgrounds, focus on key product features, and create consistent image sizes for your product catalog. Perfect for Amazon, eBay, Shopify, and other e-commerce platforms.</p>
                </div>
            </div>
            
            <div class="toggle-container">
                <div class="toggle-header" onclick="toggleContent('use3')">
                    <h4>Photo Editing & Enhancement</h4>
                    <i class="fas fa-chevron-down toggle-icon" id="icon-use3"></i>
                </div>
                <div class="toggle-content" id="content-use3">
                    <p>Remove unwanted elements from photos, focus on subjects, and improve composition. Whether you're a photographer, designer, or casual user, cropping helps you create more impactful images by eliminating distractions and emphasizing key elements.</p>
                </div>
            </div>
            
            <div class="toggle-container">
                <div class="toggle-header" onclick="toggleContent('use4')">
                    <h4>Document Scanning</h4>
                    <i class="fas fa-chevron-down toggle-icon" id="icon-use4"></i>
                </div>
                <div class="toggle-content" id="content-use4">
                    <p>Clean up scanned documents, receipts, and ID cards by cropping out unnecessary borders and backgrounds. Create professional-looking document images for digital storage, sharing, or printing. Perfect for students, professionals, and anyone who needs to digitize paperwork.</p>
                </div>
            </div>
            
            <h2>How to Use the Image Cropper</h2>
            <ol>
                <li><strong>Upload</strong> - Click "Choose File" or drag and drop your image onto the upload area</li>
                <li><strong>Select Ratio</strong> - Choose from preset ratios (1:1, 4:3, 16:9) or set custom dimensions</li>
                <li><strong>Adjust Crop</strong> - Drag the crop area or resize handles to select the portion you want to keep</li>
                <li><strong>Crop</strong> - Click "Crop Image" to process your selection</li>
                <li><strong>Download</strong> - Click "Download Cropped Image" to save your edited file</li>
            </ol>
            
            <div class="faq-section">
                <h2>Frequently Asked Questions</h2>
                <div class="toggle-container">
                    <div class="toggle-header" onclick="toggleContent('faq1')">
                        <h4>Is this image cropper really free?</h4>
                        <i class="fas fa-chevron-down toggle-icon" id="icon-faq1"></i>
                    </div>
                    <div class="toggle-content" id="content-faq1">
                        <p>Yes, our image cropper is completely free to use with no limitations, registrations, or watermarks. Crop as many images as you need at no cost. We believe in providing valuable tools without hidden fees or premium restrictions.</p>
                    </div>
                </div>
                
                <div class="toggle-container">
                    <div class="toggle-header" onclick="toggleContent('faq2')">
                        <h4>What file formats are supported?</h4>
                        <i class="fas fa-chevron-down toggle-icon" id="icon-faq2"></i>
                    </div>
                    <div class="toggle-content" id="content-faq2">
                        <p>We support all major image formats for upload including JPG, JPEG, PNG, GIF, and WEBP. The cropped output will be in JPG format for optimal compatibility and file size. Our system automatically converts your images to the most efficient format for web use.</p>
                    </div>
                </div>
                
                <div class="toggle-container">
                    <div class="toggle-header" onclick="toggleContent('faq3')">
                        <h4>Will my image quality be affected?</h4>
                        <i class="fas fa-chevron-down toggle-icon" id="icon-faq3"></i>
                    </div>
                    <div class="toggle-content" id="content-faq3">
                        <p>Cropping typically maintains or improves image quality by removing unnecessary parts and focusing on the key subject. The cropped area retains the original resolution and clarity. For best results, start with high-quality source images and crop to smaller dimensions rather than enlarging cropped areas.</p>
                    </div>
                </div>
                
                <div class="toggle-container">
                    <div class="toggle-header" onclick="toggleContent('faq4')">
                        <h4>Is my privacy protected?</h4>
                        <i class="fas fa-chevron-down toggle-icon" id="icon-faq4"></i>
                    </div>
                    <div class="toggle-content" id="content-faq4">
                        <p>Absolutely. Your images are processed directly in your browser and never uploaded to our servers. We don't store or access your files in any way. Once you close the browser tab, all processed data is automatically deleted from your device's memory.</p>
                    </div>
                </div>
            </div>
            
            <div class="related-tools">
                <h3>Related Free Tools</h3>
                <div class="tools-grid">
                    <a href="/image-resizer" class="tool-link">Image Resizer</a>
                    <a href="/image-compressor" class="tool-link">Image Compressor</a>
                    <a href="/image-converter" class="tool-link">Image Converter</a>
                    <a href="/photo-editor" class="tool-link">Photo Editor</a>
                </div>
            </div>
        </article>
    </section>

    <footer>
        <div class="container">
            <p>© 2023 Tools Hub - Your Daily Tools, All At One Place</p>
        </div>
    </footer>
    
    <!-- Adsterra Ad Code -->
    <script async="async" data-cfasync="false" src="//pl28047254.effectivegatecpm.com/a066ce0b5c2ab4f8b4fedb09d93370eb/invoke.js"></script>
    <div id="container-a066ce0b5c2ab4f8b4fedb09d93370eb"></div>
    <!-- End Adsterra Ad Code -->

    <script>
        // Toggle functionality
        function toggleContent(id) {
            const content = document.getElementById('content-' + id);
            const icon = document.getElementById('icon-' + id);
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('active');
                icon.style.transform = 'rotate(180deg)';
            }
        }
        
        // DOM Elements
        const uploadArea = document.getElementById('uploadArea');
        const uploadBtn = document.getElementById('uploadBtn');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const previewImage = document.getElementById('previewImage');
        const cropOverlay = document.getElementById('cropOverlay');
        const cropSelection = document.getElementById('cropSelection');
        const presetButtons = document.querySelectorAll('.preset-btn');
        const customDimensions = document.getElementById('customDimensions');
        const customWidth = document.getElementById('customWidth');
        const customHeight = document.getElementById('customHeight');
        const cropBtn = document.getElementById('cropBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const originalSizeEl = document.getElementById('originalSize');
        const croppedSizeEl = document.getElementById('croppedSize');
        const cropDimensionsEl = document.getElementById('cropDimensions');
        const spaceSavedEl = document.getElementById('spaceSaved');
        const processing = document.getElementById('processing');
        const statusMessage = document.getElementById('statusMessage');

        // Variables
        let originalFile = null;
        let originalSize = 0;
        let originalWidth = 0;
        let originalHeight = 0;
        let selectedRatio = '1:1';
        let isDragging = false;
        let isResizing = false;
        let dragStartX, dragStartY;
        let resizeHandle = null;
        let croppedBlob = null;

        // Event Listeners
        uploadBtn.addEventListener('click', () => fileInput.click());
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#4361ee';
            uploadArea.style.background = 'rgba(67, 97, 238, 0.05)';
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.borderColor = '#e0e0e0';
            uploadArea.style.background = '#fafafa';
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#e0e0e0';
            uploadArea.style.background = '#fafafa';
            
            if (e.dataTransfer.files.length) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFile(e.target.files[0]);
            }
        });

        // Preset buttons
        presetButtons.forEach(button => {
            button.addEventListener('click', () => {
                presetButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                selectedRatio = button.getAttribute('data-ratio');
                
                if (selectedRatio === 'custom') {
                    customDimensions.style.display = 'flex';
                } else {
                    customDimensions.style.display = 'none';
                }
                
                if (originalFile) {
                    initializeCropSelection();
                }
            });
        });

        // Crop selection events
        cropSelection.addEventListener('mousedown', startDragging);
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', stopDragging);

        // Handle resize handles
        const handles = document.querySelectorAll('.crop-handle');
        handles.forEach(handle => {
            handle.addEventListener('mousedown', startResizing);
        });

        cropBtn.addEventListener('click', cropImage);
        downloadBtn.addEventListener('click', downloadCroppedImage);

        // Helper Functions
        function validateFile(file, maxSizeMB = 5) {
            const maxSize = maxSizeMB * 1024 * 1024;
            const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            
            if (file.size === 0) {
                return { isValid: false, errors: ['File is empty.'] };
            }
            
            if (!allowedTypes.includes(file.type)) {
                return { isValid: false, errors: ['Unsupported file type. Please use JPG, PNG, GIF, or WEBP.'] };
            }
            
            if (file.size > maxSize) {
                return { isValid: false, errors: [`File too large. Maximum size is ${maxSizeMB}MB.`] };
            }
            
            const extension = file.name.split('.').pop().toLowerCase();
            return { 
                isValid: true, 
                fileInfo: { extension } 
            };
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showStatus(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = 'status-message';
            if (type) {
                statusMessage.classList.add(type);
            }
        }

        // Main Functions
        function handleFile(file) {
            // Reset previous state
            resetState();
            
            // Validate file
            const validation = validateFile(file, 5);
            if (!validation.isValid) {
                showStatus(validation.errors[0], 'error');
                return;
            }

            originalFile = file;
            originalSize = file.size;
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    originalWidth = this.width;
                    originalHeight = this.height;
                    
                    // Update preview
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                    previewContainer.querySelector('div').style.display = 'none';
                    
                    // Update file info
                    originalSizeEl.textContent = formatFileSize(file.size);
                    cropDimensionsEl.textContent = `${originalWidth} × ${originalHeight} px`;
                    
                    // Enable crop button
                    cropBtn.disabled = false;
                    
                    // Initialize crop selection
                    initializeCropSelection();
                    
                    showStatus('Image loaded successfully! Adjust the crop area and click crop.', 'success');
                };
                
                img.onerror = function() {
                    showStatus('Error loading image. Please try a different file.', 'error');
                };
                
                img.src = e.target.result;
            };
            
            reader.onerror = function() {
                showStatus('Error reading file. Please try again.', 'error');
            };
            
            reader.readAsDataURL(file);
        }

        function initializeCropSelection() {
            // Reset crop selection
            cropSelection.style.width = '0px';
            cropSelection.style.height = '0px';
            cropSelection.style.left = '0px';
            cropSelection.style.top = '0px';
            
            // Remove existing handles
            const existingHandles = document.querySelectorAll('.crop-handle');
            existingHandles.forEach(handle => handle.remove());
            
            // Create new handles
            const handles = ['nw', 'ne', 'sw', 'se'];
            handles.forEach(handle => {
                const handleElement = document.createElement('div');
                handleElement.className = `crop-handle handle-${handle}`;
                cropSelection.appendChild(handleElement);
            });
            
            // Set initial crop area based on selected ratio
            const containerRect = previewContainer.getBoundingClientRect();
            const containerWidth = containerRect.width;
            const containerHeight = containerRect.height;
            
            let cropWidth, cropHeight;
            
            if (selectedRatio === 'custom') {
                cropWidth = parseInt(customWidth.value) || 200;
                cropHeight = parseInt(customHeight.value) || 200;
            } else {
                const [ratioWidth, ratioHeight] = selectedRatio.split(':').map(Number);
                const ratio = ratioWidth / ratioHeight;
                
                if (containerWidth / containerHeight > ratio) {
                    cropHeight = containerHeight * 0.7;
                    cropWidth = cropHeight * ratio;
                } else {
                    cropWidth = containerWidth * 0.7;
                    cropHeight = cropWidth / ratio;
                }
            }
            
            cropSelection.style.width = `${cropWidth}px`;
            cropSelection.style.height = `${cropHeight}px`;
            cropSelection.style.left = `${(containerWidth - cropWidth) / 2}px`;
            cropSelection.style.top = `${(containerHeight - cropHeight) / 2}px`;
        }

        function startDragging(e) {
            if (e.target.classList.contains('crop-handle')) return;
            
            isDragging = true;
            const rect = cropSelection.getBoundingClientRect();
            dragStartX = e.clientX - rect.left;
            dragStartY = e.clientY - rect.top;
            e.preventDefault();
        }

        function startResizing(e) {
            isResizing = true;
            resizeHandle = e.target.classList[1].split('-')[1]; // nw, ne, sw, se
            e.preventDefault();
        }

        function handleMouseMove(e) {
            if (isDragging) {
                const containerRect = previewContainer.getBoundingClientRect();
                const containerWidth = containerRect.width;
                const containerHeight = containerRect.height;
                
                const selectionRect = cropSelection.getBoundingClientRect();
                const selectionWidth = selectionRect.width;
                const selectionHeight = selectionRect.height;
                
                let newLeft = e.clientX - containerRect.left - dragStartX;
                let newTop = e.clientY - containerRect.top - dragStartY;
                
                // Boundary checks
                newLeft = Math.max(0, Math.min(newLeft, containerWidth - selectionWidth));
                newTop = Math.max(0, Math.min(newTop, containerHeight - selectionHeight));
                
                cropSelection.style.left = `${newLeft}px`;
                cropSelection.style.top = `${newTop}px`;
            }
            
            if (isResizing) {
                const containerRect = previewContainer.getBoundingClientRect();
                const containerWidth = containerRect.width;
                const containerHeight = containerRect.height;
                
                const selectionRect = cropSelection.getBoundingClientRect();
                let newWidth = selectionRect.width;
                let newHeight = selectionRect.height;
                let newLeft = parseFloat(cropSelection.style.left);
                let newTop = parseFloat(cropSelection.style.top);
                
                const mouseX = e.clientX - containerRect.left;
                const mouseY = e.clientY - containerRect.top;
                
                switch (resizeHandle) {
                    case 'nw':
                        newWidth = selectionRect.right - containerRect.left - mouseX;
                        newHeight = selectionRect.bottom - containerRect.top - mouseY;
                        newLeft = mouseX;
                        newTop = mouseY;
                        break;
                    case 'ne':
                        newWidth = mouseX - (selectionRect.left - containerRect.left);
                        newHeight = selectionRect.bottom - containerRect.top - mouseY;
                        newTop = mouseY;
                        break;
                    case 'sw':
                        newWidth = selectionRect.right - containerRect.left - mouseX;
                        newHeight = mouseY - (selectionRect.top - containerRect.top);
                        newLeft = mouseX;
                        break;
                    case 'se':
                        newWidth = mouseX - (selectionRect.left - containerRect.left);
                        newHeight = mouseY - (selectionRect.top - containerRect.top);
                        break;
                }
                
                // Maintain aspect ratio if not custom
                if (selectedRatio !== 'custom') {
                    const [ratioWidth, ratioHeight] = selectedRatio.split(':').map(Number);
                    const ratio = ratioWidth / ratioHeight;
                    
                    if (newWidth / newHeight > ratio) {
                        newHeight = newWidth / ratio;
                    } else {
                        newWidth = newHeight * ratio;
                    }
                }
                
                // Boundary checks
                newWidth = Math.max(50, Math.min(newWidth, containerWidth - newLeft));
                newHeight = Math.max(50, Math.min(newHeight, containerHeight - newTop));
                newLeft = Math.max(0, Math.min(newLeft, containerWidth - newWidth));
                newTop = Math.max(0, Math.min(newTop, containerHeight - newHeight));
                
                cropSelection.style.width = `${newWidth}px`;
                cropSelection.style.height = `${newHeight}px`;
                cropSelection.style.left = `${newLeft}px`;
                cropSelection.style.top = `${newTop}px`;
            }
        }

        function stopDragging() {
            isDragging = false;
            isResizing = false;
            resizeHandle = null;
        }

        function cropImage() {
            if (!originalFile) {
                showStatus('Please upload an image first.', 'error');
                return;
            }

            processing.style.display = 'flex';
            cropBtn.disabled = true;
            showStatus('Processing image...', '');

            setTimeout(() => {
                try {
                    // Get crop dimensions
                    const selectionRect = cropSelection.getBoundingClientRect();
                    const containerRect = previewContainer.getBoundingClientRect();
                    
                    const cropWidth = selectionRect.width;
                    const cropHeight = selectionRect.height;
                    const cropLeft = selectionRect.left - containerRect.left;
                    const cropTop = selectionRect.top - containerRect.top;
                    
                    // Create canvas for cropping
                    const canvas = document.createElement('canvas');
                    canvas.width = cropWidth;
                    canvas.height = cropHeight;
                    const ctx = canvas.getContext('2d');
                    
                    // Draw the cropped portion
                    const img = new Image();
                    img.onload = function() {
                        // Calculate scale factors
                        const scaleX = img.width / containerRect.width;
                        const scaleY = img.height / containerRect.height;
                        
                        // Draw cropped portion
                        ctx.drawImage(
                            img,
                            cropLeft * scaleX, 
                            cropTop * scaleY,
                            cropWidth * scaleX,
                            cropHeight * scaleY,
                            0, 
                            0,
                            cropWidth,
                            cropHeight
                        );
                        
                        // Convert to blob
                        canvas.toBlob(function(blob) {
                            if (blob) {
                                croppedBlob = blob;
                                
                                // Update UI with results
                                const croppedSize = blob.size;
                                croppedSizeEl.textContent = formatFileSize(croppedSize);
                                cropDimensionsEl.textContent = `${Math.round(cropWidth)} × ${Math.round(cropHeight)} px`;
                                spaceSavedEl.textContent = formatFileSize(originalSize - croppedSize);
                                
                                // Enable download button
                                downloadBtn.disabled = false;
                                
                                showStatus('Image cropped successfully! Click download to save.', 'success');
                                
                                // Track crop event
                                if (typeof dataLayer !== 'undefined') {
                                    dataLayer.push({
                                        'event': 'tool_crop',
                                        'toolName': 'Image Cropper',
                                        'cropWidth': Math.round(cropWidth),
                                        'cropHeight': Math.round(cropHeight)
                                    });
                                }
                            } else {
                                showStatus('Cropping failed. Please try again.', 'error');
                            }
                            
                            processing.style.display = 'none';
                            cropBtn.disabled = false;
                        }, 'image/jpeg', 0.9);
                    };
                    
                    // Load the original image
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(originalFile);
                    
                } catch (error) {
                    console.error('Crop error:', error);
                    showStatus(`Error: ${error.message || 'Cropping failed'}`, 'error');
                    processing.style.display = 'none';
                    cropBtn.disabled = false;
                }
            }, 100);
        }

        function downloadCroppedImage() {
            if (!croppedBlob) {
                showStatus('Please crop an image first.', 'error');
                return;
            }

            try {
                const url = URL.createObjectURL(croppedBlob);
                const link = document.createElement('a');
                const filename = getCroppedFilename(originalFile.name);
                link.download = filename;
                link.href = url;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                URL.revokeObjectURL(url);
                
                showStatus(`Successfully downloaded ${filename}`, 'success');
                
                // Show success message
                showSuccessMessage(`✓ Downloaded: ${filename}`);
                
                // Track download event
                if (typeof dataLayer !== 'undefined') {
                    dataLayer.push({
                        'event': 'tool_download',
                        'toolName': 'Image Cropper',
                        'fileSize': croppedBlob.size
                    });
                }
                
            } catch (error) {
                console.error('Download error:', error);
                showStatus(`Error: ${error.message || 'Download failed'}`, 'error');
            }
        }

        function getCroppedFilename(originalName) {
            const nameWithoutExt = originalName.substring(0, originalName.lastIndexOf('.')) || originalName;
            return `${nameWithoutExt}_cropped.jpg`;
        }

        function resetState() {
            originalFile = null;
            croppedBlob = null;
            downloadBtn.disabled = true;
            processing.style.display = 'none';
            showStatus('', '');
        }

        // Success message function
        function showSuccessMessage(message) {
            const successMessage = document.createElement('div');
            successMessage.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 500;
            `;
            successMessage.textContent = message;
            document.body.appendChild(successMessage);

            setTimeout(() => {
                if (successMessage.parentNode) {
                    successMessage.parentNode.removeChild(successMessage);
                }
            }, 3000);
        }

        // Ensure page loads properly
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Image Cropper page loaded successfully');
        });
    </script>
</body>
</html>
